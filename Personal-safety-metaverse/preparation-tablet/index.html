<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="flexible" content="initial-dpr=2"/>
    <meta name="viewport" content="width=device-width,user-scalable=0,viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="color-scheme" content="light dark">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-title" content="耳膜应用场景">
    <meta name="description" content="耳膜应用场景">
    <title>耳膜应用场景</title>
    <!--[if lt IE 9]>
    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="../favicon.ico">
    <link href="../css/reset.css" rel="stylesheet" type="text/css">
    <link href="../css/common.css?v20230720" rel="stylesheet" type="text/css">
    <link href="../dist/animate.min.css" rel="stylesheet" type="text/css">
    <link href="../dist/swiper/css/swiper.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="../innovationRoom/dist/threesixty/threesixty.css">
    <link href="../css/index2.css?v20231211" rel="stylesheet" type="text/css"/>

    <script type="text/javascript" src="https://res2.wx.qq.com/open/js/jweixin-1.6.0.js"></script>

    <script src="../dist/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../dist/flexible.js"></script>
    <script type="text/javascript" src="../dist/vue.global.min.js"></script>
    <script type="text/javascript" src="../pano/tour.js"></script>
    <script type="text/javascript" src="pano/settings/init.js?v20231024"></script>

    <script type="text/javascript" src="../js/common.js"></script>
    <script type="text/javascript" src="../../Content/js/loadingJs.js" id="main" data-baseurl="../../" data-main="../js/http.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RTPS8DHXHH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RTPS8DHXHH');
    </script>
</head>
<body>

<div id="app">
    <noscript>
        <table style="width:100%;height:100%;">
            <tr style="vertical-align:middle;">
                <td>
                    <div style="text-align:center;">ERROR:<br/><br/>Javascript not activated<br/><br/></div>
                </td>
            </tr>
        </table>
    </noscript>

    <div id="pano" style="width:100%;height:100%;" @click="onInstructionClick"></div>

    <div class="page-container page-construction zoomContainer">
        <div class="control-layer" @click="onInstructionClick">
            <div class="logo flex flex-vc flex-hc">
                <img src="assets/img/logo.png" alt="" class="w-100">
            </div>

            <a class="btn-back flex flex-vc flex-hc" href="javascript:;" @click="goBack()">
                <img src="assets/img/icon_back.png" alt="" class="icon-back">
                <span>返回</span>
            </a>

            <div class="control-right-top flex-column flex-v-end">
                <div class="service-center mobile-show flex-column flex-hc" onclick="showServiceCenter()">
                    <img src="../images/btn_service_center.png" alt="" class="icon-service">
                </div>

                <div class="nav-game mobile-show flex-column flex-hc">
                    <a href="javascript:;" @click="goGame()">
                        <img src="../images/icon_game.png?v20230413" alt="" class="icon-game">
                    </a>
                </div>
            </div>

            <div class="left-control">
                <div class="btn btn-bgm flex-column flex-vc flex-hc" onclick="onPlayBgm()">
                    <span class="icon"></span>
                    <span>音乐</span>
                    <audio style="opacity: 0; height: 0" src="../images/bgm.mp3" id="bgm"
                           loop autoplay="autoplay" preload="auto"></audio>
                </div>
                <div class="btn btn-jieshuo flex-column flex-vc flex-hc">
                    <span class="icon"></span>
                    <span>解说</span>
                    <audio style="opacity: 0; height: 0" :src="jieshuoSrc" id="jieshuo"
                           autoplay="autoplay" preload="auto"></audio>
                </div>
            </div>

            <div class="control-top">
                <span class="top-title" v-cloak>
                    {{secondarySceneList[secondarySceneIndex].sceneList[sceneIndex].name}}
                </span>
            </div>
            <div class="control-right">
                <div class="right-btn-img" v-for="(item, index) in curAlertList" :key="index"
                     :style="{backgroundImage: `url(${index === alertIndex ? item.btnActive : item.btn})`}"
                     :data-name="item.name" v-cloak
                     @click="onAlertClick(index)"></div>

                <a class="btn-msg" href="https://psd-contenthub.3m.com.cn/p/9332d" target="_blank" @click="goContenthub()">
                    <img src="../images/btn_msg.png?v20230721" alt="" class="w-100 ">
                </a>
            </div>

            <div class="control-bottom">
                <div class="scene-select-box" v-show="showScenePreview" v-cloak>
                    <div class="scene-preview-list swiper-container scenePreviewSwiper">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide preview-box"
                                 v-for="(item, index) in secondarySceneList[secondarySceneIndex].sceneList" :key="index"
                                 :class="{active: index === sceneIndex}" v-cloak
                                 @click="onSceneClick(index)">
                                <div class="preview-content">
                                    <img :src="item.previewImg" alt="" class="img-preview">
                                    <span class="scene-name">{{item.name}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <ul class="secondary-scene-list flex flex-vc flex-hc">
                        <li class="item" v-for="(item, index) in secondarySceneList" :key="index"
                            :class="{active: index === secondarySceneIndex}" v-cloak
                            @click="onSecondarySceneClick(index)">
                            {{item.secondarySceneName}}
                        </li>
                    </ul>
                </div>
                <div class="bottom-option-box flex flex-hc flex-v-stretch">
                    <div class="scene-select-btn flex-column flex-vc flex-hc"
                         :class="{active: showScenePreview}" v-cloak
                         @click="onScenePreviewClick()">
                        <img src="assets/img/icon_scene.png" alt="" class="icon">
                        <span>场景选择</span>
                    </div>
                    <ul class="solution-list flex flex-vc flex-hc">
                        <li class="item flex-column flex-vc flex-hc"
                            v-for="(item, index) in curAlertList" :key="index"
                            :class="{active: index === curAlertIndex }" v-cloak
                            @click="onClickSolution(index)">
                            <img :src="item.solutionIcon" alt="" class="solution-btn" v-cloak>
                            <div class="solution-name" v-cloak>{{item.name}}</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!--危害弹框-->
        <div class="alert-box" v-if="showAlertBox" v-cloak>
            <div class="box">
                <div class="box-content">
                    <div class="btn-close" @click="closeAlertBox">X</div>
                    <div class="title flex flex-vc">
                        <div class="icon-img">
                            <img :src="curAlertList[curAlertIndex].alertBoxIcon" alt="" class="w-100">
                        </div>
                        <div class="name"><span>{{curAlertList[curAlertIndex].name}}</span></div>
                    </div>
                    <div class="alert-info">
                        <div class="p">
                            {{curAlertList[curAlertIndex].text}}
                        </div>
                        <ul class="product-list flex flex-vc margin-top-xs">
                            <li class="product-item" v-for="(item, index) in curProductList.slice(0, 3)" :key="index"
                                @click="onClickAlertProduct(index)">
                                <div class="product-img">
                                    <img :src="item.img" alt="" class="w-100">
                                </div>
                            </li>
                        </ul>
                        <div class="link" @click="showProductList(curAlertIndex, curAlertList[curAlertIndex].solutionName)">
                            <span>查看安全防护解决方案</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!--产品弹框-->
        <div class="modal-container modal-3d flex flex-vc flex-hc animated fadeIn" v-show="showProductModal" v-cloak>
            <div class="modal-body animated slideInRight">
                <div class="modal-content">
                    <div class="modal-title" v-if="curAlertList.length > 0 && curSolutionIndex != -1">
                        {{curSolutionList[curSolutionIndex].solutionTitle}}解决方案
                    </div>
                    <div class="sub-title padding-sm text-content text-lg text-center" v-if="curAlertList.length > 0 && curSolutionIndex != -1">
                        {{curSolutionList[curSolutionIndex].solutionText}}
                    </div>
                    <div class="modal-content-bottom flex flex-hc">
                        <div class="right">
                            <div class="product-list swiper-container productListSwiper">
                                <div class="swiper-wrapper">
                                    <div class="swiper-slide swiper-no-swiping"
                                         v-for="(item, index) in curProductList"
                                         :key="index" v-cloak>
                                        <div class="product-box flex flex-vc flex-hc">
                                            <div class="product-img" v-if="item.product360 == null">
                                                <img :src="item.img" alt=""
                                                     class="w-100">
                                            </div>
                                            <div class="product-img product360Box flex flex-vc flex-hc w-100 h-100 relative"
                                                 v-else>
                                                <div class="spinner flex-column flex-vc flex-hc">
                                                    <img src="../innovationRoom/map/loading.gif">
                                                    <span>0%</span>
                                                </div>
                                                <div class="threesixty"
                                                     :class="'productImgList-' + index">
                                                    <ol class="threesixty_images"></ol>
                                                </div>
                                            </div>
                                            <div class="product-info-wrap">
                                                <div class="product-info-box">
                                                    <div class="product-type margin-bottom-sm">
                                                        {{item.name}}
                                                    </div>
                                                    <div class="product-desc margin-tb-sm text-content">
                                                        {{item.productDesc}}
                                                    </div>
                                                    <ul class="product-link-list margin-top-sm">
                                                        <li class="link-item"
                                                            v-for="(item, index) in item.productLink"
                                                            :key="index">
                                                            <a :href="item.link" target="_blank" v-show="item.link"
                                                               @click="onProductLinkClick(index)">
                                                                {{item.text}}
                                                            </a>
                                                        </li>
                                                        <li class="link-item">
                                                            <a href="https://shop.m.jd.com/?shopId=84511" target="_blank" @click="goJD(index)">去京东看看</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="product-preview-list">
                                <div class="swiper-container productPreviewSwiper">
                                    <div class="swiper-wrapper flex flex-vc">
                                        <div class="swiper-slide product-item"
                                             :class="{active: index === curProductIndex}"
                                             v-for="(item, index) in curProductList"
                                             :key="index" v-cloak
                                             @click="onProductClick(index)">
                                            <div class="product-img">
                                                <img :src="item.img" alt="" class="w-100">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="btn-close" @click="onCloseProductModal()">关闭</div>
            </div>
        </div>

        <!--服务中心弹框-->
        <div class="modal-container modal-service-center flex flex-vc flex-hc animated fadeIn" style="z-index: 1000; display: none;">
            <div class="modal-bg" onclick="hideServiceCenter()"></div>
            <div class="modal-body">
                <div class="modal-title text-center text-white margin-tb">3M服务中心</div>
                <div class="modal-content">
                    <div class="img">
                        <img src="../images/service_center_ewm.png" alt="" class="w-100">
                    </div>
                    <div class="text-center text-content text-white margin-tb p">扫码进入3M个人防护小程序，获取更多防护知识信息。</div>
                </div>
            </div>
        </div>

        <!--操作指示-->
        <div class="instruction-container pc-show flex flex-vc flex-hc instructionContainer" v-cloak v-if="showInstruction">
            <img src="../images/instruction.png" alt="" class="instruction-img">
        </div>
    </div>

</div>

<script type="text/javascript" src="../dist/swiper/js/swiper.min.js"></script>
<script type="text/javascript" src="../innovationRoom/dist/threesixty/threesixty.min.js"></script>
<!-- <script src="//cbe.convertlab.com/cbe/collect?tid=5742798233695064425&at=0&h=web"></script> -->
<script type="text/javascript" src="../js/clab_tracker.js?v20231212"></script>
<script type="text/javascript" src="js/index.js?v20231211"></script>
<script type="text/javascript" src="js/pointDisplay.js?v20231212"></script>
<script type="text/javascript" src="../js/bgm.js"></script>
<script type="text/javascript" src="../dist/current-device.min.js"></script>
<script type="text/javascript" src="../dist/devicePixelRatio.js"></script>

<script type="text/javascript">
    var scenePreviewSwiper = new Swiper(".scenePreviewSwiper", {
        slidesPerView: 'auto',
    });

    //产品缩略图
    var productPreviewSwiper = new Swiper(".productPreviewSwiper", {
        slidesPerView: 'auto',
        watchSlidesVisibility: true,
        watchSlidesProgress: true,
    });
    //产品列表
    var productListSwiper = new Swiper(".productListSwiper", {
        noSwiping: true,
        thumbs: {
            swiper: productPreviewSwiper
        }
    });

    function updateSwiper() {
        setTimeout(() => {
            productListSwiper.update();
            productPreviewSwiper.update();
            scenePreviewSwiper.update();
        }, 100);
    }

    function showSolution() {
        updateSwiper();
        vm.showScenePreview = false;
        let sceneId = vm.sceneIndex,
            secondarySceneId = vm.secondarySceneIndex,
            solutionId = vm.curSolutionIndex,
            productId = vm.productIndex;

        if (vm.secondarySceneList[secondarySceneId].sceneList[sceneId].products[solutionId].productList[productId].product360) {
            let src = vm.secondarySceneList[secondarySceneId].sceneList[sceneId].products[solutionId].productList[productId].product360.src,
                num = vm.secondarySceneList[secondarySceneId].sceneList[sceneId].products[solutionId].productList[productId].product360.num;
            console.log(sceneId, solutionId, productId);
            setTimeout(function () {
                showProduct(src, num, 'productImgList-' + productId);
            }, 100)
        }
        $(".modal-3d").fadeIn();
        $(".modal-body").removeClass("slideOutRightBig").addClass("slideInRight");
    }

    //360产品展示
    function show360(src, totalFrames, productImgList) {
        productImgList = $('.' + productImgList).ThreeSixty({
            totalFrames: totalFrames,
            endFrame: totalFrames,
            currentFrame: 1,

            imgList: '.threesixty_images',
            progress: '.spinner',
            imagePath: 'https://file-sjune.oss-cn-hangzhou.aliyuncs.com/PSD/360Products/' + src + '/',
            filePrefix: '',
            ext: '.png',
            height: 400,
            width: 400,
            navigation: false,
            responsive: true
        });
    }

    function showProduct(src, totalFrames, productImgList) {
        $(".spinner").show();
        $(".threesixty_images").html("");
        show360(src, totalFrames, productImgList);

        $(".productImg").attr("src", src);
        $(".product360Box").show();
    }

    function showServiceCenter() {
        $(".modal-service-center").fadeIn();
    }

    function hideServiceCenter() {
        $(".modal-service-center").hide();
    }

</script>
</body>
</html>
